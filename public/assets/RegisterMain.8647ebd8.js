import{d as h,u as g,a as f,r as P,c as b,b as s,w as t,e as k,o as w,f as x,g as c,t as A,h as U,i as q,s as z,j as C,k as r}from"./index.1e5e80b3.js";import{u as F,r as p,e as S,c as T,_ as M,a as u}from"./AppFormGroup.57537ecc.js";import{_ as R}from"./AppButton.b4ec5f9d.js";import{A as d}from"./AppControl.684aaebb.js";import{_ as B}from"./AppCard.3ad22048.js";import{_ as E}from"./AppAlert.0560d307.js";const j={class:"w-full flex-1 flex items-center justify-center"},L=c("Create a Free Account "),W=h({__name:"RegisterMain",setup(D){const $=k(),_=g(),v=f("error"),n=f(""),i=f(!1),m=P({username:"",password:"",repeatPassword:"",firstName:"",lastName:""}),e=F({username:{required:p,email:S,$lazy:!0},password:{required:p,$lazy:!0},repeatPassword:{required:p,sameAs:T.withMessage("Password fields should match.",l=>l===m.password),$lazy:!0},firstName:{$lazy:!0},lastName:{$lazy:!0}},m),N=()=>{e.value.username.$model="",e.value.password.$model="",e.value.repeatPassword.$model="",e.value.firstName.$model="",e.value.lastName.$model="",e.value.$reset()},V=l=>{if(l.name)if(l.name==="AxiosError"){const{message:a}=l.response.data;n.value=a,N()}else console.warn(l.message);else console.error(l)},y=()=>(i.value=!0,e.value.$validate().then(l=>{if(l)return z.user.create({username:m.username,password:m.password,firstName:m.firstName,lastName:m.lastName});throw new Error("Form is not valid.")}).then(l=>new Promise(a=>{setTimeout(()=>{a(void 0)},1e3)}).then(()=>{_.updateAuthState(!0,l.accessToken,l.refreshToken)}).then(()=>$.push({name:C.dashboard}))).catch(V).finally(()=>{i.value=!1}));return(l,a)=>(w(),b("div",j,[s(B,{class:"sm:max-w-sm"},{default:t(()=>[n.value?(w(),x(E,{key:0,type:v.value},{default:t(()=>[c(A(n.value),1)]),_:1},8,["type"])):U("",!0),s(M,{onSubmit:a[5]||(a[5]=q(o=>y(),["prevent"])),ref_key:"form",ref:m},{default:t(()=>[s(u,{class:"w-full",label:"Username",for:"username",required:!0,errors:r(e).username.$errors},{default:t(()=>[s(d,{modelValue:r(e).username.$model,"onUpdate:modelValue":a[0]||(a[0]=o=>r(e).username.$model=o),error:r(e).username.$error,class:"w-full",placeholder:"Username...",id:"username"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"Password",for:"password",required:!0,errors:r(e).password.$errors},{default:t(()=>[s(d,{modelValue:r(e).password.$model,"onUpdate:modelValue":a[1]||(a[1]=o=>r(e).password.$model=o),error:r(e).password.$error,type:"password",placeholder:"Password...",class:"w-full",id:"password"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"Repeat password",for:"repeat-password",required:!0,errors:r(e).repeatPassword.$errors},{default:t(()=>[s(d,{modelValue:r(e).repeatPassword.$model,"onUpdate:modelValue":a[2]||(a[2]=o=>r(e).repeatPassword.$model=o),error:r(e).repeatPassword.$error,type:"password",placeholder:"Repeat password...",class:"w-full",id:"repeat-password"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"First name",for:"first-name",errors:r(e).firstName.$errors},{default:t(()=>[s(d,{modelValue:r(e).firstName.$model,"onUpdate:modelValue":a[3]||(a[3]=o=>r(e).firstName.$model=o),error:r(e).firstName.$error,class:"w-full",placeholder:"First name",id:"first-name"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"Last name",for:"last-name",required:!0,errors:r(e).lastName.$errors},{default:t(()=>[s(d,{modelValue:r(e).lastName.$model,"onUpdate:modelValue":a[4]||(a[4]=o=>r(e).lastName.$model=o),error:r(e).lastName.$error,class:"w-full",placeholder:"Last name",id:"last-name"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full"},{default:t(()=>[s(R,{loading:i.value,type:"submit",class:"w-full"},{default:t(()=>[L]),_:1},8,["loading"])]),_:1})]),_:1},512)]),_:1})]))}});export{W as default};
