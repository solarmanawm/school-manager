import{_ as A,d as _,u as g,a as P,b as i,r as b,c as x,e as s,w as t,o as w,f as k,g as c,t as F,h as U,i as C,s as M,j as R,k as r}from"./index.93ca6e21.js";import{u as q,r as f,e as z,c as S,A as T,a as u}from"./AppFormGroup.6dd6e794.js";import{A as B}from"./AppButton.b0f6ca87.js";import{A as d}from"./AppControl.932a4855.js";import{A as j}from"./AppCard.1307c386.js";import{A as E}from"./AppAlert.f0eb5ddf.js";const L={class:"w-full flex-1 flex items-center justify-center"},D=c("Create a Free Account "),G=_({__name:"RegisterMain",setup(H){const $=g(),v=P(),N=i("error"),n=i(""),p=i(!1),m=b({username:"",password:"",repeatPassword:"",firstName:"",lastName:""}),e=q({username:{required:f,email:z,$lazy:!0},password:{required:f,$lazy:!0},repeatPassword:{required:f,sameAs:S.withMessage("Password fields should match.",o=>o===m.password),$lazy:!0},firstName:{$lazy:!0},lastName:{$lazy:!0}},m),V=()=>{e.value.username.$model="",e.value.password.$model="",e.value.repeatPassword.$model="",e.value.firstName.$model="",e.value.lastName.$model="",e.value.$reset()},h=o=>{if(o.name)if(o.name==="AxiosError"){const{message:a}=o.response.data;n.value=a,V()}else console.warn(o.message);else console.error(o)},y=()=>(p.value=!0,e.value.$validate().then(o=>{if(o)return M.user.create({username:m.username,password:m.password,firstName:m.firstName,lastName:m.lastName});throw new Error("Form is not valid.")}).then(o=>new Promise(a=>{setTimeout(()=>{a(void 0)},1e3)}).then(()=>{v.updateAuthState(!0,o.accessToken,o.refreshToken)}).then(()=>$.push({name:R.dashboard}))).catch(h).finally(()=>{p.value=!1}));return(o,a)=>(w(),x("div",L,[s(j,{class:"sm:max-w-sm"},{default:t(()=>[n.value?(w(),k(E,{key:0,type:N.value},{default:t(()=>[c(F(n.value),1)]),_:1},8,["type"])):U("v-if",!0),s(T,{onSubmit:a[5]||(a[5]=C(l=>y(),["prevent"])),ref_key:"form",ref:m},{default:t(()=>[s(u,{class:"w-full",label:"Username",for:"username",required:!0,errors:r(e).username.$errors},{default:t(()=>[s(d,{modelValue:r(e).username.$model,"onUpdate:modelValue":a[0]||(a[0]=l=>r(e).username.$model=l),error:r(e).username.$error,class:"w-full",placeholder:"Username...",id:"username"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"Password",for:"password",required:!0,errors:r(e).password.$errors},{default:t(()=>[s(d,{modelValue:r(e).password.$model,"onUpdate:modelValue":a[1]||(a[1]=l=>r(e).password.$model=l),error:r(e).password.$error,type:"password",placeholder:"Password...",class:"w-full",id:"password"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"Repeat password",for:"repeat-password",required:!0,errors:r(e).repeatPassword.$errors},{default:t(()=>[s(d,{modelValue:r(e).repeatPassword.$model,"onUpdate:modelValue":a[2]||(a[2]=l=>r(e).repeatPassword.$model=l),error:r(e).repeatPassword.$error,type:"password",placeholder:"Repeat password...",class:"w-full",id:"repeat-password"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"First name",for:"first-name",errors:r(e).firstName.$errors},{default:t(()=>[s(d,{modelValue:r(e).firstName.$model,"onUpdate:modelValue":a[3]||(a[3]=l=>r(e).firstName.$model=l),error:r(e).firstName.$error,class:"w-full",placeholder:"First name",id:"first-name"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full",label:"Last name",for:"last-name",required:!0,errors:r(e).lastName.$errors},{default:t(()=>[s(d,{modelValue:r(e).lastName.$model,"onUpdate:modelValue":a[4]||(a[4]=l=>r(e).lastName.$model=l),error:r(e).lastName.$error,class:"w-full",placeholder:"Last name",id:"last-name"},null,8,["modelValue","error"])]),_:1},8,["errors"]),s(u,{class:"w-full"},{default:t(()=>[s(B,{loading:p.value,type:"submit",class:"w-full"},{default:t(()=>[D]),_:1},8,["loading"])]),_:1})]),_:1},512)]),_:1})]))}});var Y=A(G,[["__file","/home/dmitry/PhpstormProjects/school-manager-web/src/frontend/components/RegisterMain.vue"]]);export{Y as default};
